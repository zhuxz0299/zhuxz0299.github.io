---
title: 分圆扩张与分圆多项式
cover: 'https://source.fomal.cc/img/default_cover_184.webp'
categories: [Lecture Notes, Applied Algebra]
katex: true
abbrlink: 66767fa
date: 2025-12-11 21:41:53
description:
---


## 分圆扩张的定义与背景

我们讨论在域 $F$ 上的多项式 $x^n - 1$ 的分裂域 $S$。为了保证根的性质良好（即没有重根），我们首先需要对域的特征及其与 $n$ 的关系做出限定。

> **前提条件**
> 假定域 $F$ 的特征 $\text{char}(F) \nmid n$。
> * 如果 $\text{char}(F) = p > 0$，则要求 $p \nmid n$。
> * 如果 $\text{char}(F) = 0$，则无限制。

在这种条件下，$(x^n - 1)' = n x^{n-1} \neq 0$，且与 $x^n - 1$ 互素（因为两者没有公共根），因此 $x^n - 1$ 在分裂域中有 $n$ 个不同的根。

典型例子：
* $F = \mathbb{Q}$，则 $S \subseteq \mathbb{C}$，根的形式为 $e^{\frac{2k\pi i}{n}}$。
* $F$ 为有限域时，即为有限域的扩张。

## 单位根群的结构

记 $U_n$ 为 $x^n - 1$ 在分裂域 $S$ 中的所有根的集合：
$$U_n = \{ \alpha \in S \mid \alpha^n = 1 \}$$

我们已知 $|U_n| = n$。

为了确定 $U_n$ 的群结构，我们需要引入一个重要的代数引理。

> **引理：有限子群定理**
> 设 $F$ 是一个域。若 $G$ 是 $F^*$（即 $F \setminus \{0\}$，域的乘法群）的有限子群，则 $G$ 是**循环群**。
>
> *注：有限域 $F$ 的乘法群 $F^*$ 本身是循环群，即为该定理的一个特例。*

> **定理：单位根群结构**
> $U_n$ 关于乘法构成一个循环群。
> 它的结构同构于模 $n$ 的整数加法群：
> $$(U_n, \cdot) \cong (\mathbb{Z}_n, +)$$

**定理证明过程：**
我们要证明 $(U_n, \cdot)$ 是循环群。由上述引理，我们只需证明 $U_n$ 是 $S^*$ 的子群即可。
1.  **子群判定**：对于任意 $\alpha, \beta \in U_n$，我们需要验证 $\alpha\beta^{-1} \in U_n$。
    $$(\alpha\beta^{-1})^n = \alpha^n (\beta^n)^{-1} = 1 \cdot 1^{-1} = 1$$
    
    因为 $(\alpha\beta^{-1})^n = 1$，所以 $\alpha\beta^{-1}$ 也是 $x^n - 1$ 的根，即 $\alpha\beta^{-1} \in U_n$。
2.  **结论**：$U_n$ 是 $S^*$ 的有限子群，根据引理，$U_n$ 必定是循环群。


### 本原单位根 (Primitive Roots)

由于 $U_n$ 是循环群，我们可以选取它的生成元。

> **定义：本原单位根**
> $U_n$ 的生成元称为 **$1$ 的本原 $n$ 次根**。记 $\omega_n$ 为 $1$ 的某一个本原 $n$ 次根，则有：
> $$U_n = \langle \omega_n \rangle = \{ 1, \omega_n, \omega_n^2, \dots, \omega_n^{n-1} \}$$

**元素的阶 (Order)：**
对于任意 $\omega_n^k \in U_n$：
$$\text{ord}(\omega_n^k) = n \iff \gcd(n, k) = 1$$

记 $\Omega_n$ 为所有本原 $n$ 次根的集合：
$$\Omega_n = \{ \omega_n^k \mid 1 \le k \le n, \gcd(n, k) = 1 \}$$

其元素个数为欧拉函数 $|\Omega_n| = \phi(n)$。

同时可以发现 $\Omega_n$ 与 $\mathbb{Z}_n^{*}$ 的元素存在一一对应关系：$\omega_n^{k} \leftrightarrow k$ 

## 分圆扩张与伽罗瓦群

> **定义：分圆扩张 (Cyclotomic Extension)**
> 域 $F$ 上 $x^n - 1$ 的分裂域 $S$ 称为 $F$ 上的 $n$ 阶**分圆扩张**。
>
> 我们可以将其写为单扩张形式：
> $$S = F(U_n) = F(\omega_n)$$
> 
> 其中 $\omega_n$ 是任意一个本原 $n$ 次根。

> **注：关于生成元的选取**
> 虽然 $S$ 一定可以由本原根生成，但可能存在 $\omega_n'$ **不是**本原 $n$ 次根，却依然满足 $S = F(\omega_n')$。

**实例分析 ($n=15$)：**
考虑 $x^{15}-1$ 在 $F = \mathbb{F}_2$ 上的分裂域。
1.  多项式 $x^4+x+1$ 在 $\mathbb{F}_2$ 上不可约。设其根为 $\alpha$。
    经计算 $\text{ord}(\alpha) = 15$，即 $\alpha$ 为本原根。
    此时 $S = \mathbb{F}_2(\alpha) = \mathbb{F}_{16}$。（$\alpha$ 也是域 $\mathbb{F}_{16}$ 的本原元）。
2.  考虑另一个多项式 $m_3(x) = x^4+x^3+x^2+x+1$。
    它有一个根为 $\alpha^3$。因为 $\text{ord}(\alpha^3) = \frac{15}{(15, 3)} = 5 \neq 15$，所以 $\alpha^3$ **不是** $15$ 次本原根。
3.  **但是**，依然有 $S = \mathbb{F}_2(\alpha^3) = \mathbb{F}_{16}$。
    *(这说明即便元素不是本原 $n$ 次根，它生成的域也可能等于整个分圆扩张域)*。

由于 $\text{char}(F) \nmid n$，该扩张是可分的，且是分裂域，因此 $S/F$ 是 **伽罗瓦扩张 (Galois Extension)**。

### 伽罗瓦群的结构映射

我们要研究伽罗瓦群 $G = \text{Gal}(S/F)$ 的结构。
对于任意 $\sigma \in \text{Gal}(S/F)$，$\sigma$ 由它在生成元 $\omega_n$ 上的作用，即 $\sigma(\omega_n)$ 唯一确定。
由于 $\sigma(\omega_n)$ 必须仍是 $x^n - 1$ 的根，且必须保持元素的阶不变（即仍为本原根），故：
$$\sigma(\omega_n) = \omega_n^k, \quad \text{其中 } \gcd(n, k) = 1$$

> **定理：伽罗瓦群的嵌入**
> 存在一个单射群同态 $k$:
> $$\text{Gal}(S/F) \hookrightarrow \mathbb{Z}_n^*$$
> 
> 这意味着分圆扩张的伽罗瓦群同构于模 $n$ 乘法群 $\mathbb{Z}_n^*$ 的一个**子群**。因此，分圆扩张的伽罗瓦群总是**阿贝尔群 (Abelian)**。

**证明思路：**
引入映射 $k: \sigma \mapsto k(\sigma)$，使得 $k(\sigma) = \log_{\omega_n}\sigma(\omega_n)$，即满足 $\sigma(\omega_n) = \omega_n^{k(\sigma)}$。
1.  **同态性**：$\sigma(\tau(\omega_n)) = \sigma(\omega_n^{k(\tau)}) = (\omega_n^{k(\sigma)})^{k(\tau)} = \omega_n^{k(\sigma)k(\tau)}$，对应于群乘法。
2.  **单射性**：若 $k(\sigma) = 1$，则 $\sigma(\omega_n) = \omega_n$，即 $\sigma$ 固定生成元，故 $\sigma = \text{id}$。

**注意**：$k$ 不一定是满射。
* 在 $F = \mathbb{Q}$ 时，$k$ 是同构，即 $|\text{Gal}(S/F)| = \phi(n)$。
* 在有限域 $F_q$ 上，往往只是真子群。
* *例子*：考虑 $F = \mathbb{F}_2$，扩张 $F_{16} = \mathbb{F}_2(\omega_{15})$。$|\text{Gal}| = 4$，但 $|\mathbb{Z}_{15}^*| = \phi(15) = 8$。

## 分圆多项式 (Cyclotomic Polynomials)

<!-- 我们需要找到 $\omega_n$ 在 $F$ 上的极小多项式。为此引入分圆多项式 $Q_n(x)$（通常也记为 $\Phi_n(x)$）。 -->

### 根的分类与定义推导

记 $U_n$ 为 $x^n - 1$ 的根集。对于任意 $\omega \in U_n$，$\text{ord}(\omega)$ 必整除 $n$。
我们可以按照元素的阶（Order）对根进行分类：
对于 $n$ 的任意因子 $d$ ($d \mid n$)，记 $\omega_d$ 为本原 $d$ 次根，即 $\text{ord}(\omega_d) = d$。
考虑所有本原 $d$ 次根的集合，形式为 $\omega_d^k$，其中 $(k, d) = 1, 1 \le k < d$。这个集合的大小为 $\phi(d)$。

> **定义：分圆多项式**
> 令 $Q_d(x)$ 为以所有本原 $d$ 次根为根的多项式：
> $$Q_d(x) = \prod_{\substack{\text{ord}(\alpha) = d \\ \alpha \in U_n}} (x - \alpha) = \prod_{\substack{1 \le k \le d \\ \gcd(k, d) = 1}} (x - \omega_d^k)$$

由根的分解关系，我们有：
$$x^n - 1 = \prod_{\alpha \in U_n} (x - \alpha) = \prod_{d | n} \left( \prod_{\text{ord}(\alpha)=d} (x - \alpha) \right) = \prod_{d | n} Q_d(x)$$

### 基本性质

> **性质：分圆多项式的属性**
> 1.  **次数**：$\deg(Q_d) = \phi(d)$。
> 2.  **分解公式**：$x^n - 1 = \prod_{d | n} Q_d(x)$。
> 3.  **系数性质**：$Q_n(x)$ 的系数属于 $F$ 的素子域（若 $\text{char}(F)=p$，则为 $\mathbb{Z}_p$；若 $\text{char}(F)=0$，则为 $\mathbb{Q}$ 且实际在 $\mathbb{Z}$ 中）。

**系数性质的证明 (归纳法)**

* **基础步骤**：当 $n=1$ 时，$Q_1(x) = x - 1$，系数显然在素子域中，成立。
* **归纳假设**：假设对于任意 $d \mid n$ 且 $d < n$，$(Q_d(x))$ 的系数都属于 $F$ 的素子域。
* **归纳步骤**：由分解公式 $x^n - 1 = \prod_{d|n} Q_d(x)$，可变形为：
    $$x^n - 1 = Q_n(x) \cdot \underbrace{\prod_{d|n, d<n} Q_d(x)}_{g(x)}$$
    
    其中 $g(x)$ 根据归纳假设，其系数属于素子域。
    因为 $x^n - 1$ 的系数在素子域中，且 $g(x)$ 是首一多项式（Monic），通过多项式除法可知，$Q_n(x) = \frac{x^n - 1}{g(x)}$ 的系数也必然属于素子域。
* **特别地**：当 $F=\mathbb{Q}$ 时，结合高斯引理 (Gauss Lemma) 和归纳法，可知 $Q_n(x) \in \mathbb{Z}[x]$（整系数多项式）。

### $Q_n(x)$ 的具体计算实例

#### 方法一：利用分解公式

1.  **$n=1$**:
    $$Q_1(x) = x - 1$$
2.  **$n=2$**:
    $$x^2 - 1 = Q_1(x)Q_2(x) \implies Q_2(x) = \frac{x^2-1}{x-1} = x + 1$$
3.  **$n=p$ (素数)**:
    $$x^p - 1 = Q_1(x)Q_p(x) \implies Q_p(x) = \frac{x^p-1}{x-1} = \sum_{i=0}^{p-1} x^i$$
4.  **$n=4$**:
    $$Q_4(x) = \frac{x^4 - 1}{Q_1(x)Q_2(x)} = \frac{x^4 - 1}{(x-1)(x+1)} = \frac{x^4 - 1}{x^2 - 1} = x^2 + 1$$
5.  **$n=15$ (较复杂的例子)**:
    $$Q_{15}(x) = \frac{x^{15} - 1}{Q_1(x) Q_3(x) Q_5(x)}$$
    
    经过多项式除法计算，结果为：
    $$Q_{15}(x) = x^8 - x^7 + x^5 - x^4 + x^3 - x + 1$$
    
    *注：在某些域（如 $\mathbb{F}_2$）下，$Q_{15}(x)$ 可以分解为 2 个 4 次多项式。这说明分圆多项式不一定不可约（依赖于基域）。*

#### 方法二：Mobius 反演公式 (Mobius Inversion)
这是通用的显式计算公式。

> **公式：Mobius 反演**
> $$Q_n(x) = \prod_{d | n} (x^d - 1)^{\mu(n/d)}$$
> 
> 其中 $\mu$ 是 Mobius 函数：
> * $\mu(1) = 1$
> * $\mu(n) = (-1)^k$，若 $n$ 是 $k$ 个不同素数的乘积
> * $\mu(n) = 0$，若 $n$ 含平方因子

**例：计算 $Q_6(x)$**
因子 $d \in \{1, 2, 3, 6\}$。
$\mu(6/1) = 1, \mu(3) = -1, \mu(2) = -1, \mu(1) = 1$。
$$Q_6(x) = \frac{(x-1)(x^6-1)}{(x^2-1)(x^3-1)} = x^2 - x + 1$$

## 可约性讨论：有理域 vs 有限域

分圆多项式 $Q_n(x)$ 的可约性严重依赖于基域 $F$。我们需要先建立伽罗瓦群大小与多项式可约性之间的逻辑联系。

### 伽罗瓦群与可约性的逻辑推导

回顾之前建立的单射同态 $k: \text{Gal}(S/F) \to \mathbb{Z}_n^*$。
我们已知 $|\mathbb{Z}_n^*| = \phi(n)$。

**推导过程：**
1.  **假设同构**：如果 $|\text{Gal}(S/F)| = \phi(n)$，由于 $k$ 是单射且两边阶数相等，则 $k$ 必为**满射**，即 $\text{Gal}(S/F) \cong \mathbb{Z}_n^*$。
2.  **扩张次数关联**：由伽罗瓦理论基本定理，扩张次数等于群的阶：
    $$[S:F] = |\text{Gal}(S/F)|$$
3.  **极小多项式**：因为 $S = F(\omega_n)$，扩张次数 $[S:F]$ 等于生成元 $\omega_n$ 的极小多项式 $\min(\omega_n, F)$ 的次数。
    $$[S:F] = \deg(\min(\omega_n, F))$$
4.  **整除关系**：另一方面，我们知道 $Q_n(\omega_n) = 0$（$\omega_n$ 是分圆多项式的根），且 $\deg(Q_n) = \phi(n)$。这说明极小多项式 $\min(\omega_n, F)$ 一定整除 $Q_n(x)$。
5.  **结论**：
    如果 $|\text{Gal}(S/F)| = \phi(n)$，则 $\deg(\min(\omega_n, F)) = \phi(n) = \deg(Q_n)$。
    由于 $Q_n(x)$ 是首一多项式，次数相等且存在整除关系意味着它们相等：
    $$\min(\omega_n, F) = Q_n(x) \iff Q_n(x) \text{ 在 } F \text{ 上不可约}$$

综上所述，我们得到如下判定准则：

> **判定准则**
> $$|\text{Gal}(S/F)| = \phi(n) \iff \text{Gal}(S/F) \cong \mathbb{Z}_n^* \iff Q_n(x) \text{ 在 } F \text{ 上不可约}$$

### 不同情形下的可约性
**情形 1：$F = \mathbb{Q}$**

> **定理：有理域上的不可约性**
> $Q_n(x)$ 在 $\mathbb{Q}[x]$ 上是**不可约**的。
>
> * **扩张次数**：$[S : \mathbb{Q}] = \deg(Q_n) = \phi(n)$。
> * **伽罗瓦群**：$\text{Gal}(S/\mathbb{Q}) \cong \mathbb{Z}_n^*$（满射同构）。

**情形 2：$F = \mathbb{F}_q$ (有限域)**

> **结论：有限域上的可约性**
> $Q_n(x)$ 在有限域上**通常是可约的**，除非 $\text{Gal}(S/F)$ 生成了整个 $\mathbb{Z}_n^*$。
>
> $[S : F]$ 等于 $\omega_n$ 在 $F$ 上的极小多项式次数，这通常小于 $\phi(n)$。

### 实例分析

#### 例 1：$\mathbb{F}_2$ 上的 $x^7 - 1$
计算 $n=7$ 的分圆多项式 $Q_7(x)$：
在 $\mathbb{Q}$ 上，$Q_7(x) = x^6 + x^5 + x^4 + x^3 + x^2 + x + 1$（不可约）。
但在 $\mathbb{F}_2$ 上，我们发现 $Q_7(x)$ 可以分解：
$$Q_7(x) = (x^3 + x + 1)(x^3 + x^2 + 1)$$

这两个因子在 $\mathbb{F}_2$ 上都不可约。
因此，扩张次数 $[S : \mathbb{F}_2] = 3$（而不是 $\phi(7)=6$）。

#### 例 2：$\mathbb{Q}(\omega_7)$ 的伽罗瓦对应 (Galois Correspondence)
**1. 设定与群结构**
设 $F = \mathbb{Q}$，$\omega$ 为本原 $7$ 次单位根，$E = \mathbb{Q}(\omega)$。
已知扩张次数 $[E:\mathbb{Q}] = \phi(7) = 6$。
伽罗瓦群结构如下：
$$\text{Gal}(E/\mathbb{Q}) \cong \mathbb{Z}_7^* = \{1, 2, 3, 4, 5, 6\} = \langle 3 \rangle$$

这是一个 6 阶循环群。记 $\sigma_k$ 为满足 $\sigma_k(\omega) = \omega^k$ 的自同构。
生成元为 $\sigma_3$，即 $\text{Gal}(E/\mathbb{Q}) = \langle \sigma_3 \rangle$。

**2. 子群格 (Lattice of Subgroups)**
$\langle \sigma_3 \rangle$ 的子群由其阶数的因子唯一确定。$6$ 的因子有 $1, 2, 3, 6$。
共有 4 个子群：
* **Order 1**: $\{ \text{id} \}$
* **Order 6**: $\langle \sigma_3 \rangle$ (全群)
* **Order 3**: $\langle \sigma_3^2 \rangle = \langle \sigma_2 \rangle = \{1, 2, 4\}$
* **Order 2**: $\langle \sigma_3^3 \rangle = \langle \sigma_6 \rangle = \{1, 6\}$

**3. 寻找中间域：以 $\langle \sigma_3^3 \rangle$ 为例**
我们考察阶为 2 的子群 $H = \langle \sigma_3^3 \rangle$。
由于 $\sigma_3^3 \equiv \sigma_{27} \equiv \sigma_6 \pmod 7$，故 $H = \langle \sigma_6 \rangle$。
计算其固定域 $\text{Fix}(H)$。

* **构造固定元素**：
    考察 $\sigma_6$ 的作用：
    $$\sigma_6(\omega) = \omega^6$$

    $$\sigma_6(\omega^6) = (\omega^6)^6 = \omega^{36} = \omega^1$$

    显见 $\sigma_6$ 交换 $\omega$ 和 $\omega^6$。因此，元素 $\alpha = \omega + \omega^6$ 在 $\sigma_6$ 作用下不变：
    $$\sigma_6(\omega + \omega^6) = \omega^6 + \omega$$

    于是 $\mathbb{Q}(\omega + \omega^6) \subseteq \text{Fix}(H)$。

* **确定扩张次数**：
    根据伽罗瓦理论基本定理：
    $$[E : \text{Fix}(H)] = |H| = 2$$

    $$[\text{Fix}(H) : \mathbb{Q}] = [E : \mathbb{Q}] / 2 = 6 / 2 = 3$$
    
    对于我们构造的域 $K = \mathbb{Q}(\omega + \omega^6)$，有 $K \subseteq \text{Fix}(H)$。
    这意味着 $[K : \mathbb{Q}]$ 必须整除 $[\text{Fix}(H) : \mathbb{Q}] = 3$。
    所以 $[K : \mathbb{Q}]$ 只能是 $1$ 或 $3$。

* **排除 $[K : \mathbb{Q}] = 1$ (反证法)**：
    如果 $[K : \mathbb{Q}] = 1$，则 $\omega + \omega^6 \in \mathbb{Q}$。
    这意味着该元素被伽罗瓦群中的**所有**元素固定。
    我们任取 $\sigma \in \text{Gal}(E/\mathbb{Q})$，例如取 $\sigma_2$（注意 $\sigma_2(\omega)=\omega^2$）：
    若 $\omega + \omega^6 \in \mathbb{Q}$，则应有 $\sigma_2(\omega + \omega^6) = \omega + \omega^6$。
    
    计算左边：
    $$\sigma_2(\omega + \omega^6) = \omega^2 + \omega^{12} = \omega^2 + \omega^5$$
    
    令其相等：
    $$\omega^2 + \omega^5 = \omega + \omega^6 \implies \omega^6 - \omega^5 - \omega^2 + \omega = 0$$
    
    这表明 $\omega$ 是多项式 $f(x) = x^6 - x^5 - x^2 + x$ 的根。
    
    **矛盾**：$\omega$ 在 $\mathbb{Q}$ 上的极小多项式是分圆多项式 $Q_7(x) = x^6 + x^5 + x^4 + x^3 + x^2 + x + 1$。
    由于 $\deg(f(x)) < \deg(Q_7(x))$ 且 $f(x) \neq 0$，这与极小多项式的定义矛盾。
    
    $\therefore \omega + \omega^6 \notin \mathbb{Q}$，即 $[K : \mathbb{Q}] \neq 1$。

* **结论**：
    必须有 $[\mathbb{Q}(\omega + \omega^6) : \mathbb{Q}] = 3$。
    因此，中间域正是：
    $$\text{Fix}(\langle \sigma_6 \rangle) = \mathbb{Q}(\omega + \omega^6) = \mathbb{Q}(\omega + \omega^{-1})$$

**4. 另一个中间域 (简述)**
对于阶为 3 的子群 $\langle \sigma_3^2 \rangle = \langle \sigma_2 \rangle = \{ \sigma_1, \sigma_2, \sigma_4 \}$。
考察元素 $\beta = \omega + \omega^2 + \omega^4$。
验证 $\sigma_2(\beta)$：
$$\sigma_2(\omega + \omega^2 + \omega^4) = \omega^2 + \omega^4 + \omega^8 = \omega^2 + \omega^4 + \omega = \beta$$
同理可证 $\mathbb{Q}(\beta)$ 即为对应的 2 次中间域。