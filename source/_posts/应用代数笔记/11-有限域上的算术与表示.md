---
title: 有限域上的算术与表示
cover: 'https://source.fomal.cc/img/default_cover_183.webp'
categories: applied algebra
katex: true
description: 涵盖了有限域算术、极小多项式求解、分圆多项式分解以及Berlekamp因式分解算法。
abbrlink: 253f8bf0
date: 2025-12-04 21:28:43
---

## 有限域上的算术

### 域的构造与元素表示

考虑有限域 $F_{16}$ 的构造。我们将其看作是 $F_2$ 的单代数扩张 $F_{16} = F_2(\alpha)$。
选取 $F_2$ 上的一个 4 次不可约多项式：
$$p(x) = x^4 + x + 1$$

**1. 验证 $p(x)$ 的不可约性**
要证明 $p(x)$ 在 $F_2$ 上不可约，需验证它没有低次因子：
* **无一次因子（无根）**：
    代入 $0$：$p(0) = 1 \neq 0$
    代入 $1$：$p(1) = 1 + 1 + 1 = 1 \neq 0$
    故 $p(x)$ 在 $F_2$ 上无根，即无一次因子。
* **无二次因子**：
    $F_2$ 上唯一的不可约二次多项式是 $x^2+x+1$。
    做多项式除法：$(x^4+x+1) \div (x^2+x+1) = x^2+x \dots \text{余 } 1$。
    无法整除，故无二次因子。

综上，$p(x)$ 是 $F_2$ 上的不可约多项式。

**2. 构造扩域**
令 $\alpha$ 为 $p(x)$ 的一个根，即 $p(\alpha) = 0$。
由此得到基本关系式：
$$\alpha^4 + \alpha + 1 = 0 \implies \alpha^4 = \alpha + 1$$

> **注**：从抽象代数的角度，这等价于构造商环 $F_{16} \cong F_2[x] / \langle x^4+x+1 \rangle$。这里的 $\alpha$ 对应于商环中 $x$ 的陪集 $\bar{x}$。

**3. 元素的枚举**
在 $F_{16}$ 中，所有元素都可以唯一表示为次数小于 4 的多项式：
$$\beta = c_3\alpha^3 + c_2\alpha^2 + c_1\alpha + c_0, \quad c_i \in \{0, 1\}$$
总共有 $2^4 = 16$ 个元素，我们可以按次数对其进行分类：

* **0 次（及零元素）**：
    $0, \quad 1$
* **1 次**：
    $\alpha, \quad \alpha + 1$
* **2 次**：
    $\alpha^2, \quad \alpha^2 + 1, \quad \alpha^2 + \alpha, \quad \alpha^2 + \alpha + 1$
* **3 次**（共 8 个）：
    $\alpha^3, \quad \alpha^3 + 1, \quad \alpha^3 + \alpha, \quad \alpha^3 + \alpha + 1$
    $\alpha^3 + \alpha^2, \quad \alpha^3 + \alpha^2 + 1, \quad \alpha^3 + \alpha^2 + \alpha, \quad \alpha^3 + \alpha^2 + \alpha + 1$

**4. 乘法群的循环结构**
上述多项式表达虽然适合加法（系数对应相加），但在做乘法时较为繁琐。
为了简化乘法运算，我们利用有限域乘法群的性质：$F_{16}$ 的非零元素构成的乘法群 $F_{16}^*$ 是一个**循环群** (Cyclic Group)。

这意味着存在生成元，使得每个非零元素 $\beta \in F_{16}^*$ 都可以唯一地表示为生成元的幂次。若 $\alpha$ 是生成元，则有：
$$F_{16}^* = \langle \alpha \rangle = \{ \alpha^0, \alpha^1, \alpha^2, \dots, \alpha^{14} \}$$
这引入了元素的**指数形式**（Power Representation）。

> **两种表示法的对比**
> * **多项式形式**（Polynomial Basis）：如上所示的所有形式。非常适合进行**加法**运算（对应系数模 2 相加）。
> * **指数形式**（Power Form）：如 $\alpha^k$。非常适合进行**乘法**运算。

### 本原元 (Primitive Element) 的验证

我们需要验证 $\alpha$ 是否为 $F_{16}^*$ 的生成元（即本原元）。

1.  **群的阶**：$|F_{16}^*| = 2^4 - 1 = 15$。
2.  **验证方法**：$\alpha$ 的阶 (order) 必须是 15 的因子。15 的因子有 1, 3, 5, 15。
    * 显然 $\alpha^1 \neq 1$。
    * 检查 $\alpha^3$：由于次数小于4，显然 $\alpha^3 \neq 1$。
    * 检查 $\alpha^5$：
        利用 $\alpha^4 = \alpha + 1$，
        $$\alpha^5 = \alpha \cdot \alpha^4 = \alpha(\alpha+1) = \alpha^2 + \alpha \neq 1$$
3.  **结论**：因为 $\alpha^3 \neq 1$ 且 $\alpha^5 \neq 1$，所以 $\text{order}(\alpha) = 15$。因此，$\alpha$ 是 $F_{16}$ 的本原元。同时 $order(p(x)) = 15$，表明 $p(x)$ 为本原多项式。

**幂次表推导（部分）**：
* $\alpha^0 = 1$
* $\alpha^1 = \alpha$
* $\alpha^2 = \alpha^2$
* $\alpha^3 = \alpha^3$
* $\alpha^4 = \alpha + 1$
* $\alpha^5 = \alpha(\alpha + 1) = \alpha^2 + \alpha$
* $\alpha^6 = \alpha(\alpha^2 + \alpha) = \alpha^3 + \alpha^2$
* ...
* $\alpha^{15} = 1$

### 混合运算示例

**例：计算 $(\alpha^2+\alpha+1)(\alpha^3+\alpha^2)$**

$$
\begin{aligned}
& (\alpha^8 + \alpha^4 + 1)(\alpha^3 + \alpha) \\
=\ & (0101 + 0011 + 0001)(1000 + 0010) \\
=\ & 0111 \cdot 1010 \\
=\ & \alpha^{10} \cdot \alpha^9 = \alpha^{19} = \alpha^4 = \alpha + 1
\end{aligned}
$$
## Frobenius 映射与共轭元

### Frobenius 自同构

考虑映射 $\sigma: F_{16} \to F_{16}$，定义为 $\sigma(\beta) = \beta^2$。可以看出如果 $\beta \in F_2$，那么 $\sigma(\beta) = \beta$，即 $\sigma$ 是 $F_2$-自同构。
对于 $F_{2^n}$，Galois 群是循环群 $\langle \sigma \rangle$。
在 $F_{16}$ 中，$\sigma^4(\beta) = \beta^{16} = \beta$，那么 $\langle \sigma \rangle = \{ \sigma^{0} = \iota, \sigma^{1}, \sigma^{2}, \sigma^{3} \}$

### 共轭类与极小多项式

对于域中元素 $\beta$，其在 $F_2$ 上的极小多项式 $m_\beta(x)$ 的根是 $\beta$ 的所有共轭元（即 $\beta$ 在 $\sigma$ 作用下的轨道）。

**原因**：
极小多项式 $m_\beta(x)$ 的系数属于基域 $F_2$（即伽罗瓦群的不动点域）。因此，对于任意 $\sigma \in G$，自同构 $\sigma$ 保持系数不变。若 $m_\beta(\beta) = 0$，对两边施加 $\sigma$：
$$\sigma(m_\beta(\beta)) = m_\beta(\sigma(\beta)) = 0$$

这说明如果 $\beta$ 是根，那么 $\sigma(\beta)$ 也一定是根。
因此，$m_\beta(x)$ 的根集恰好就是 $\beta$ 在 Galois 群作用下的轨道（即共轭类）。

**1. $\alpha$ 的共轭类**
计算轨道：
* $\alpha$
* $\alpha^2$
* $\alpha^4 = \alpha + 1$
* $\alpha^8 = (\alpha+1)^2 = \alpha^2 + 1$
* $\alpha^{16} = \alpha$ (循环)

共轭元为 $\{ \alpha, \alpha^2, \alpha^4, \alpha^8 \}$。
对应极小多项式：$m_\alpha(x) = (x-\alpha)(x-\alpha^2)(x-\alpha^4)(x-\alpha^8) = x^4+x+1$。

**2. $\alpha^3$ 的共轭类**
计算轨道：
* $\alpha^3$
* $(\alpha^3)^2 = \alpha^6$
* $(\alpha^6)^2 = \alpha^{12}$
* $(\alpha^{12})^2 = \alpha^{24} = \alpha^{15}\cdot\alpha^9 = \alpha^9$
* $(\alpha^9)^2 = \alpha^{18} = \alpha^3$ (循环)

共轭元为 $\{ \alpha^3, \alpha^6, \alpha^{12}, \alpha^9 \}$。
对应极小多项式：$m_{\alpha^3}(x) = x^4 + x^3 + x^2 + x + 1$。
注意：$(\alpha^3)^5 = \alpha^{15} = 1$，$\alpha^3$ 的阶为 5，不是本原元。

**3. $\alpha^5$ 的共轭类**
计算轨道：
* $\alpha^5$
* $(\alpha^5)^2 = \alpha^{10}$
* $(\alpha^{10})^2 = \alpha^{20} = \alpha^5$ (循环)

共轭元为 $\{ \alpha^5, \alpha^{10} \}$。
对应极小多项式：$m_{\alpha^5}(x) = (x-\alpha^5)(x-\alpha^{10}) = x^2 + x + 1$。
这说明 $F_2(\alpha^5) \cong F_4$ 是 $F_{16}$ 的子域。

**4. $\alpha^7$ 的共轭类**
类似可得共轭元 $\{ \alpha^7, \alpha^{14}, \alpha^{13}, \alpha^{11} \}$。
对应极小多项式：$m_{\alpha^7}(x) = x^4 + x^3 + 1$。

### 多项式分解应用

利用上述结果，可以将 $x^{15}-1$ 在 $F_2$ 上分解为不可约因子的乘积：
$$x^{15}-1 = \prod_{\beta \in F_{16}^*} (x-\beta)$$
根据共轭类分组：
$$x^{15}-1 = m_0(x) m_1(x) m_3(x) m_5(x) m_7(x)$$

* $m_0(x) = x+1$
* $m_1(x) = x^4+x+1$
* $m_3(x) = x^4+x^3+x^2+x+1$
* $m_5(x) = x^2+x+1$
* $m_7(x) = x^4+x^3+1$


## Berlekamp 因式分解算法

Berlekamp 算法用于在有限域上分解多项式。为方便起见，本节主要考虑 $\mathbb{Z}_p$ 上的多项式。

### 算法思路与核心公式

设 $f(x) \in \mathbb{Z}_p[x]$，且 $\deg(f) = d$。
我们的目标是寻找一个非平凡的多项式 $g(x) \in \mathbb{Z}_p[x]$，满足以下条件：
1.  $\deg(g) \le d-1$
2.  $f(x) \mid g(x)^p - g(x)$

**推导过程**：

* **基本恒等式**：
    考虑 $\mathbb{Z}_p$ 上的恒等式 $x^p - x = \prod_{s \in \mathbb{Z}_p} (x-s)$。
    将 $g(x)$ 代入上式：
    $$g(x)^p - g(x) = \prod_{s=0}^{p-1} (g(x) - s)$$

* **互素性质**：
    由于 $\mathbb{Z}_p$ 是域，对于不同的 $i, j \in \mathbb{Z}_p$ ($i \neq j$)，有 $\gcd(g(x)-i, g(x)-j) = 1$。即 $g(x)-i$ 各项两两互素。

* **GCD 分解公式的证明**：
    我们要证明为何 $f(x) = \prod_{s=0}^{p-1} \gcd(f(x), g(x)-s)$。
    
    1.  **设 $g(x)-i$ 的分解**：
        设 $g(x)-i$ 在 $\mathbb{Z}_p$ 上的不可约因子分解为：
        $$g(x)-i = f_{i,1}^{e_{i,1}} \cdots f_{i,m_i}^{e_{i,m_i}}$$
        
    2.  **$f(x)$ 的结构**：
        因为 $f(x) \mid \prod_{i=0}^{p-1} (g(x)-i)$，且各个 $g(x)-i$ 互素，所以 $f(x)$ 的因子必然分布在这些 $g(x)-i$ 中。
        我们可以将 $f(x)$ 写为：
        $$f(x) = \prod_{i=0}^{p-1} \left( f_{i,1}^{a_{i,1}} \cdots f_{i,m_i}^{a_{i,m_i}} \right)$$

        其中 $0 \le a_{i,k} \le e_{i,k}$。这表示 $f(x)$ 中包含的 $g(x)-i$ 的因子部分。

    3.  **提取 GCD**：
        考察 $\gcd(f(x), g(x)-i)$：
        $$\gcd(f, g-i) = f_{i,1}^{a_{i,1}} \cdots f_{i,m_i}^{a_{i,m_i}}$$
        这恰好提取了 $f(x)$ 中属于 $g(x)-i$ 因子的那一缩部分。
    
    4.  **结论**：
        将所有部分的 GCD 相乘，即可还原 $f(x)$：
        $$f(x) = \gcd(f, g^p-g) = \prod_{s=0}^{p-1} \gcd(f(x), g(x)-s)$$

通过计算 $\gcd(f(x), g(x)-s)$，我们有望将 $f(x)$ 分解为更小的因子。

### 预处理：无重因子 (Square-free)

在进行分解前，不失一般性 (W.L.O.G)，我们只考虑 $f(x)$ **没有重因子** 的情况。

**原因分析**：
1.  计算 $d(x) = \gcd(f(x), f'(x))$。
2.  若 $d(x) = 1$，则 $f(x)$ 无重因子。
3.  若 $d(x) \neq 1$，则 $d(x)$ 包含 $f(x)$ 的重因子。
    此时，$f(x)$ 的分解可以转化为对 $f(x)/d(x)$ 和 $d(x)$ 的分解。
    因此，我们只需要掌握如何处理无重因子的多项式即可。

> **结论**：在无重因子的假设下，一定存在多个（非平凡）$g(x)$，$\deg(g) < d$，使得 $f \mid g^p - g$。这样的 $g(x)$ 称为 **f-reducing polynomial**。

### 寻找 $g(x)$ 的线性代数方法

我们要寻找 $g(x) = \sum_{i=0}^{d-1} g_i x^i$ ($g_i \in \mathbb{Z}_p$) 满足 $f(x) \mid g(x)^p - g(x)$。

**推导步骤**：

1.  **计算 $g(x)^p$**：
    在 $\mathbb{Z}_p$ 中，利用 $(a+b)^p = a^p + b^p$ 和 $a^p = a$ 的性质：
    $$[g(x)]^p = \left(\sum_{i=0}^{d-1} g_i x^i\right)^p = \sum_{i=0}^{d-1} g_i^p (x^i)^p = \sum_{i=0}^{d-1} g_i x^{ip}$$

2.  **代入整除条件**：
    $$g^p - g = \sum_{i=0}^{d-1} g_i x^{ip} - \sum_{i=0}^{d-1} g_i x^i = \sum_{i=0}^{d-1} g_i (x^{ip} - x^i)$$
    我们需要 $f(x) \mid \sum_{i=0}^{d-1} g_i (x^{ip} - x^i)$。

3.  **多项式模运算**：
    对 $x^{ip}$ 做带余除法：
    $$x^{ip} = q_i(x)f(x) + r_i(x), \quad 0 \le \deg(r_i) \le d-1$$
    
    代回原式：
    $$f(x) \mid \sum_{i=0}^{d-1} g_i (r_i(x) - x^i)$$
    
    观察发现，上式右边 $\sum g_i (r_i(x) - x^i)$ 的次数严格小于 $d$（因为 $\deg(r_i) < d$ 且 $\deg(x^i) < d$）。
    一个次数小于 $d$ 的多项式若能被 $d$ 次多项式 $f(x)$ 整除，它必须恒等于 **0**。
    
    因此，我们要解的方程是：
    $$\sum_{i=0}^{d-1} g_i (r_i(x) - x^i) = 0$$

### 构造矩阵方程求解

为了求解系数 $g_i$，我们进一步展开上述多项式方程。

设 $r_i(x) = r_{i,0} + r_{i,1}x + \cdots + r_{i, d-1}x^{d-1}$。
考虑方程中 $x^j$ ($0 \le j \le d-1$) 的系数：

对于固定的 $j$，系数为：
$$\sum_{i=0}^{d-1} g_i (r_{i,j} - \delta_{i,j}) = 0$$
其中 $\delta_{i,j}$ 是 Kronecker delta 符号（当 $i=j$ 时为 1，否则为 0）。

**矩阵定义**：
定义矩阵 $M$ 为 $d \times d$ 矩阵，其元素为 $r_{i,j}$：
$$M \stackrel{\text{def}}{=} (r_{i,j})_{0 \le i, j \le d-1}$$

（注：$M$ 的第 $i$ 行即为 $x^{ip} \pmod{f(x)}$ 的系数向量）

定义系数向量 $G$：
$$G \stackrel{\text{def}}{=} (g_0, g_1, \dots, g_{d-1})$$

**最终方程**：
上述系数条件等价于线性方程组：
$$G \cdot (M - I) = 0$$

**算法总结**：
1.  求出 $G \cdot (M - I) = 0$ 的解空间基底 $g_0, g_1, \dots$。
2.  利用非平凡解构造 $g(x)$。
3.  计算 $f = \gcd(f, g) \cdots \gcd(f, g-p+1)$ 完成分解。

### 计算示例
**在 $\mathbb{Z}_2$ 上分解 $f(x) = x^6 + x^5 + x^4 + x^3 + x^2 + 1$。**